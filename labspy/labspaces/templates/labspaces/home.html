{% extends 'labspaces/layout.html' %}

{% block content %}

{% if user_labs %}
    <h1 class="text-center">Your labspaces:</h1>
    <hr>
    <div class="d-flex justify-content-center gap-3 mb-5">
        <button class="btn-1 join-lab-btn"><i class="bi bi-door-open"></i>Join an existing labspace</button>
        <button class="btn-1 create-lab-btn" onclick="window.location.href='{% url 'labspaces:lab_create' %}'"><i class="bi bi-plus-lg"></i>Create a new labspace  </button> 
    </div> 
    <div class="mx-auto w-75 p-3 d-flex gap-2 align-items-start justify-content-center flex-wrap">
        {% for lab in user_labs %}
            <div class="lab-card card mb-3" style="min-width: 18rem; max-width: 22rem; height: 11rem;">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-center">{{ lab.name }}</h5>
                    <p class="card-text text-muted">
                        {{ lab.description|default:"" }}
                    </p>
                    <a href="{% url 'labspaces:labspace_view' code=lab.code %}" class="btn btn-primary mt-auto">Go to Dashboard</a>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <h1 class="text-center">Welcome to LabSpy!</h1>
    <p class="text-center">You don't seem to have joined any labspaces yet. Join a labspace to get started.</p>
    <div class="d-flex justify-content-center gap-3">
        <button class="btn-1 join-lab-btn">Join an existing labspace</button>
    </div>
    <hr class="hr-1">
    <p class="text-center">Are you a lab owner/manager?</p>

    <div class="d-flex justify-content-center gap-3">
        <button class="btn-1 create-lab-btn" onclick="window.location.href='{% url 'labspaces:lab_create' %}'">Create a new labspace</button> 
    </div>
{% endif %}

<!-- Join Lab Modal -->
<div class="modal fade" id="joinLabModal" tabindex="-1" aria-labelledby="joinLabModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="joinLabModalLabel">Join a Labspace</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form  method="post" action="{% url "labspaces:lab_join" %}" autocomplete="off">
                    {% csrf_token %}
                    {{ join_form.as_p }}
                </form>
            </div>
            <div class="modal-body">
                <ul class="text-left">
                    <li>Every labspace has a unique 6-digit code.</li>
                    <li>If you don't have a code, contact the lab manager or a member of the labspace.</li>
                    <li>Your join request will be sent to the lab manager for approval.</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-1 cancel-btn" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn-1 join-lab-btn" form="join-lab-form">Join Labspace</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelector('.join-lab-btn').addEventListener('click', function() {
        var joinLabModal = new bootstrap.Modal(document.getElementById('joinLabModal'));
        joinLabModal.show();
    });
</script>



{% endblock %}  